# QR-Based File Upload & Download System (Dockerized)

A simple, fast, and hassle-free way for printing-shop customers to share documents without WhatsApp or Email.
Customers scan a QR code â†’ upload a file â†’ shop staff download it from a secure dashboard.

**No user login. No app installs. No printer drivers or direct printing.**
Just scan â†’ upload â†’ download â†’ print.

---

## ğŸš€ Features

### ğŸ‘¤ Customer Side
- Scan a QR code generated by the shop
- Upload PDF / Images / DOC / DOCX
- No need to save phone numbers or compose emails

### ğŸ¬ Shop Side
- Generate a short-lived session (QR code)
- See all user-uploaded files in real time
- Download files directly to shop PC
- Files auto-expire and get deleted

### ğŸ›  Technical Features
- **Backend:** Node.js + Express + Multer
- **Frontend:** React (Vite)
- **File storage:** Docker Volume (uploads-data)
- Fully Dockerized using Dockerfile + docker-compose
- Automatic cleanup: expired sessions & files
- Configurable file limits, TTLs, and storage paths

---

## ğŸ“¦ Project Structure

```
qr-print-mvp-docker/
â”œâ”€ backend/
â”‚  â”œâ”€ Dockerfile
â”‚  â”œâ”€ package.json
â”‚  â”œâ”€ server.js
â”‚  â”œâ”€ .env.example
â”‚  â””â”€ uploads/ (mounted as docker volume)
â”œâ”€ frontend/
â”‚  â”œâ”€ Dockerfile
â”‚  â”œâ”€ package.json
â”‚  â”œâ”€ vite.config.js
â”‚  â”œâ”€ index.html
â”‚  â””â”€ src/
â”‚     â”œâ”€ main.jsx
â”‚     â”œâ”€ App.jsx
â”‚     â””â”€ pages/
â”‚        â”œâ”€ UploadPage.jsx
â”‚        â””â”€ ShopDashboard.jsx
â”œâ”€ docker-compose.yml
â””â”€ README.md
```

---

## ğŸ³ Run with Docker

### 1ï¸âƒ£ Clone the project
```bash
git clone https://github.com/yourusername/qr-print-mvp-docker.git
cd qr-print-mvp-docker
```

### 2ï¸âƒ£ Build & start all services
```bash
docker-compose up --build
```

### 3ï¸âƒ£ Visit the services

| Service | URL |
|---------|-----|
| Frontend (React) | http://localhost:5173 |
| Backend API | http://localhost:3000 |

Backend health check:
```bash
GET http://localhost:3000/api/health
```

### 4ï¸âƒ£ Stop containers
```bash
docker-compose down
```

Want to also remove uploaded files?
```bash
docker-compose down -v
```

---

## ğŸ”§ How it Works

### 1. Shop Creates a Session

**Send:**
```bash
POST http://localhost:3000/api/sessions
Content-Type: application/json

{ "shopId": "shop-1" }
```

**Response:**
```json
{
  "token": "a1b2c3d4e5",
  "uploadUrl": "http://localhost:5173/upload/a1b2c3d4e5",
  "qrDataUrl": "data:image/png;base64,...",
  "expiresAt": 1713456000000
}
```

The shop displays the QR code to the customer.

### 2. Customer Uploads a File

**Open:**
```
http://localhost:5173/upload/<token>
```

**Upload via cURL:**
```bash
curl -F "file=@document.pdf" http://localhost:3000/api/upload/<token>
```

### 3. Shop Views All Files

**Open:**
```
http://localhost:5173/shop/<token>
```

Files appear automatically every 5 seconds.

**API:**
```bash
GET http://localhost:3000/api/jobs/<token>
```

### 4. Download File
```bash
GET http://localhost:3000/api/files/<jobId>   (Browser download)
```

File will be saved from the backend's volume-mapped directory.

---

## ğŸ—‚ Docker Volume for Uploads

Uploaded files are stored inside:
```
/app/uploads
```

mapped to the named Docker volume:
```
uploads-data
```

**Inspect:**
```bash
docker volume inspect uploads-data
```

**Extract files to host:**
```bash
docker run --rm -v uploads-data:/data -v $(pwd):/backup alpine cp -r /data /backup
```

---

## âš™ï¸ Environment Variables

**Backend:** `.env.example`
```env
PORT=3000
PUBLIC_URL=http://localhost:5173
UPLOAD_DIR=/app/uploads
SESSION_TTL_MIN=30
FILE_TTL_HOURS=24
MAX_FILE_SIZE_BYTES=52428800
```

**Frontend:** usually no .env needed unless deploying.

---

## ğŸ”’ Security Notes

- Session tokens auto-expire
- Files auto-deleted after TTL
- File types restricted (PDF, images, DOC, DOCX)
- Max file size configurable (default 50MB)
- QR URL is unguessable (UUID-based tokens)
- Only shop UI can download files (dashboard URL not meant to be public)
- **Use HTTPS in production**

---

## ğŸ“Œ Limitations (MVP)

- Uses in-memory session storage â†’ resets if backend restarts
- No authentication for shop dashboard (can be added)
- Not meant for multi-shop scaling yet
- No direct printing (by design â€” file download only)

---

## ğŸš€ Future Improvements

- Add PostgreSQL or Redis for sessions/jobs
- Add Socket.io for real-time uploads
- Add ClamAV for virus scanning
- Add shop login (JWT-based)
- Deploy to Docker Swarm or Kubernetes
- Support S3 bucket storage instead of local volume

---

## âœ”ï¸ Summary

This project provides a clean, fast, Dockerized solution for print shops to receive customer documents without WhatsApp, Gmail, or pen drives â€” all with QR codes and a clean UI.
